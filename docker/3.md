# Docker 持久化数据的方案

基于本地文件系统的Volume。可以在执行Docker create或Docker run时，通过-v参数将主机的目录作为容器的数据卷。这部分功能便是基于本地文件系统的volume管理。

基于plugin的Volume，支持第三方的存储方案，比如NAS，aws。

# Volume的类型

受管理的data Volume，由docker自动创建。

绑定挂载的Volume，具体挂载位置可以由用户指定。



# data Volume

在dockerfile使用了volume

![image-20201003220030343](img\image-20201003220030343.png)

如上图，mysql的dockerfile，就制定了这个container的/var/lib/mysql目录下，会被持久化。

接下来，运行这个image，然后通过：

```js
docker volume ls //查看所有的volume，会多出一个volume，即使container被删除了，volume也不会被删除。
docker volume inspect  <volume name> //查看这个volume的信息
docker volume rm <volume name> //删除掉
```

这个docker volume自动生成，不友好。

自定义：

```js
docker run -d -v mysql:/var/lib/mysql -name mysql1 -e MYSQL_ALLOW_EMPTY_PASSWORD=true mysql
```

-d 后台运行

-name 这个container的别名

-e 允许mysql空密码

mysql image名

-v mysql:/var/lib/mysql 指这个mysql image里面的dockerfile中值是/var/lib/mysql 的volume的别名为mysql。另一个container也使用这个，不会被覆盖（验证data volume生效）。

