# 第一章：架构演化

1.单机结构

2.文件、应用、数据库放在不同服务器。

3.使用本地缓存和分布式缓存

4.应用搭建集群，使用负载均衡

5.数据库读写分离

6.使用cdn和代理缓存

7.使用分布式数据库

8.使用NoSQL和搜索引擎

9.业务拆分

10.分布式服务：在业务拆分后，如果存在的话：抽取一些公用的模块，统一提供服务。（dubbo architecture roadmap）

# 第二章：网站架构模式

分层：mvc

分割：大型网站分割为购物、论坛、搜索、广告等。而购物又可以分割为机票酒店、小商品等。

分布式、集群、缓存、异步、冗余、自动化、安全



# 第三章：核心要素



# 第四章：高性能架构

## 前端性能优化

### 浏览器访问优化

1. 减少http请求（不是http连接）合并css、合并js、合并图片。
2. 浏览器缓存：对于长久不变的静态设置Cache-Control和Expires属性，如果需要及时更新到客户端浏览器，可以通过改文件名并页面引用新的文件名。这样是通过生成新的文件在缓存并html页面引用它。
3. 启用压缩：服务端进行压缩，浏览器对文件解压，有效减少通信传输数据量。压缩率达80%以上。
4. css放在页面最上面，javascript放在页面最下面。因为浏览器下载完全部css才会对页面进行渲染。浏览器在加载javaScript后立即执行javascript代码。
5. 减少cookie传输。对静态资源的访问，发送cookie没有意义，可以考虑静态资源使用独立域名访问，避免请求静态资源时发送cookie。（大多数都会让静态资源缓存，比如多益的首页，静态资源是from disk/memory cache）

### CDN加速

### 反向代理

正向代理服务器位于浏览器一侧，代理服务器将http请求发送到互联网上。

而反向代理服务器位于网站机房一侧，负责接口http请求。

反向代理服务器可以做到缓存、负载均衡。

## 应用服务器性能优化

### 分布式缓存

注意：

1. 频繁修改的数据，这种不应该放入到缓存。
2. 没有热点的访问，不遵循28定律那么缓存也没有意义，因为缓存频繁更替。
3. 允许暂时不一致。
4. 缓存的可用性，如果缓存系统奔溃，已经习惯有缓存的数据库会立马被大量连接导致宕机。
5. 缓存预热。
6. 解决缓存穿透。

### 异步操作

使用消息队列做到：削峰、异步、解耦。

注意：在后续的业务校验、写数据库等操作可能跟失败，因此在使用消息队列进行业务异步处理后，需要适当修改业务流程进行配合，如订单提交后，订单数据写入到消息队列，不应该立即返回用户订单修改成功，而是显示正在 处理该订单，直到后台真正处理完成后，再修改其状态。通过电子邮件，短信通知。也可以通过每隔1s，前端页面对后台发起询问。

### 集群

### 代码优化

1. 多线程：当前处理io操作时，cpu可以调度其他线程进行处理；多核cpu。计算公式：【总时间/cpu时间】*核数
2. 资源复用：单例和池。
3. 数据结构和算法
4. 垃圾回收

### 存储性能优化

1. 固态硬盘和机械硬盘
2. B+树和LSM树



# 第五章：高可用架构

可用性以多少个9为指标。

