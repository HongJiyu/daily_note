# 冷备

数据库停止后进行备份。

- 备份frm文件，共享表空间文件(ibdata)，独立表空间文件（.ibd），重做日志文件（ib_logfile）。
- 优点：简单，速度快。
- 缺点：文件大（表空间文件有其他数据：undo段，插入缓冲），受限操作系统，mysql版本，浮点数格式等问题。

# 逻辑备份

​       用来完成转存数据库的备份及不同数据库之间的移植。如：mysql低版本升级到高版本，从mysql数据库移植到oracle或sql server。

​		生成的是逻辑语句，也就是sql语句（表结构和数据）。

语法：

```shell
mysqldump [arguments] > file_name
mysqldump --all-databases >dump.sql
mysqldump --databases db1 db2 db3 >dump.sql
mysqldump --single-transaction test >test_back.sql
```

其他参数： 通过mysqldump --help 查看

- single-transaction : 备份前先执行了start transaction命令，指对innodb引擎有效，保证备份的一致性，但是无法隔离其他ddl语句。
- lock-tables（-l）：备份时，依次锁住对每个库的所有表。一般用于myisam引擎，和single-transaction冲突，两种引擎都有，则使用lock-tables。只能保证库下表一致性，不能保证所有库下所有表一致性。因为是依次库进行锁。
- lock-all-tables（-x）：对所有库中的表上锁，一次锁住所有库的所有表。
- add-drop-database：生成的逻辑文件，会有drop database和create database，这个参数要和 all-databases 或 databases 联合使用。
- master-data[=value]：1 文件中记录change master语句。2 change master语句被注释。默认为空。会自动忽略 --lock-tables，没使用 single-transaction则自动使用 lock-all-tables。
- hex-blob：将binary、varbinary、blog、bit备份为16进制，因为文件是文本类型，有些字符不可见。
- where ：导出给定条件的数据。
- events(-E)：备份事件调度器
- routines（-R）：备份存储过程和函数
- triggers：备份触发器

可以导出存储过程，触发器，事件，数据，但是不能导出视图。因此用mysqldump后，还需要导出视图的定义，或者备份视图定义的frm文件。

# 逻辑备份恢复

以下两种方式：

- 执行文件： mysql -uroot -p < xxx.sql
- 到mysql命令行： source /xx/xx/xx.sql 

# 逻辑备份和恢复的其他方式

使用mysqldump-tab 或 select into outfile 导出的方式：p360

恢复：p363

# 二进制日志备份与恢复

Point-In-Time  是什么